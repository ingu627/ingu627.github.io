---
layout: single
title: '[MySQL] SQL 문법 및 예제 정리 - UNION, UNION ALL'
excerpt: "실무 적용 및 SQL 코테를 위한 자료입니다."
categories: SQL
tag : [union, union all, 정리, mysql, 문법, 기초, 란, 설명, 코딩테스트, 코테, 정의]
toc: true
toc_sticky: true
sidebar_main: true

date: 2024-09-17
last_modified_at: 2024-09-17
---

<br>

## UNION 과 UNION ALL 에 대한 정리 및 설명

SQL에서 **`UNION`**과 **`UNION ALL`**은 두 개 이상의 **SELECT** 쿼리의 결과를 하나로 결합하는 데 사용되는 연산자입니다.<br>
이 두 연산자는 여러 쿼리의 결과를 결합할 때 중요한 역할을 하지만, 서로 다른 동작 방식을 가지고 있습니다.<br>
이 글에서는 `UNION`과 `UNION ALL`의 차이점, 사용법, 그리고 예제를 통해 각각의 기능을 이해해보겠습니다.
{: .notice--info}

<br>
<br>

### 1. UNION

- **`UNION`** 연산자는 두 개 이상의 **SELECT** 쿼리의 결과를 결합하고, 중복된 행을 제거하여 반환합니다. 
- 즉, **중복을 제거한 유니크한 결과**만을 반환합니다.

- **특징**:
  1. **중복 제거**: 결과에서 중복된 행은 제거됩니다.
  2. **정렬 수행**: 기본적으로 SQL 엔진은 중복을 제거하기 위해 정렬 작업을 수행하기 때문에, **비교적 더 많은 리소스를 사용**합니다.
  3. **컬럼 수와 타입 일치**: 결합하는 모든 쿼리의 **컬럼 수와 데이터 타입**이 동일해야 합니다.

<br>

- **문법**:

```sql
SELECT column_name(s) FROM table1
UNION
SELECT column_name(s) FROM table2;
```

- **예제**: 두 테이블에서 서로 다른 고객 목록을 결합하기

```sql
# `Customers_Online`과 `Customers_Offline` 테이블에서 중복되는 고객을 제거하고 유일한 고객 목록을 반환합니다.
SELECT customer_id, customer_name FROM Customers_Online
UNION
SELECT customer_id, customer_name FROM Customers_Offline;
```

<br>

### 2. UNION ALL

- **`UNION ALL`** 연산자는 두 개 이상의 **SELECT** 쿼리의 결과를 결합하며, **중복된 행을 제거하지 않고 모두 반환**합니다. 이로 인해 중복된 데이터도 모두 출력됩니다.
- **특징**:
  1. **중복 허용**: 중복된 행도 그대로 반환합니다.
  2. **성능 우위**: 중복을 제거하기 위한 정렬 작업을 하지 않기 때문에, **`UNION`보다 빠릅니다**.
  3. **컬럼 수와 타입 일치**: 결합하는 모든 쿼리의 **컬럼 수와 데이터 타입**이 동일해야 합니다.

<br>

- **문법**:

```sql
SELECT column_name(s) FROM table1
UNION ALL
SELECT column_name(s) FROM table2;
```

- **예제**: 두 테이블에서 중복을 허용하여 고객 목록 결합하기

```sql
# `Customers_Online`과 `Customers_Offline` 테이블의 고객 목록을 중복된 행까지 포함하여 모두 반환합니다.
SELECT customer_id, customer_name FROM Customers_Online
UNION ALL
SELECT customer_id, customer_name FROM Customers_Offline;
```

<br>

### 3. UNION UNION ALL의 차이점

| **특징**          | **UNION**                            | **UNION ALL**                         |
|-------------------|--------------------------------------|---------------------------------------|
| **중복된 행**     | 중복된 행을 제거                     | 중복된 행을 제거하지 않음             |
| **성능**          | 중복 제거를 위해 더 많은 리소스 사용 | 중복 제거를 하지 않으므로 더 빠름     |
| **정렬 작업**     | 중복을 제거하기 위해 정렬이 필요함   | 정렬 작업이 필요하지 않음            |
| **사용 목적**     | 중복 없는 결과를 원할 때 사용        | 모든 데이터를 그대로 출력할 때 사용  |

<br>

### 4. 사용 시 주의사항

1. **컬럼 수와 데이터 타입**:
    - `UNION` 또는 `UNION ALL`을 사용할 때, 결합하는 쿼리의 **컬럼 수와 데이터 타입이 동일**해야 합니다.
    - 각 컬럼의 **순서도 동일**해야 합니다. 예를 들어 첫 번째 컬럼이 숫자 타입이면, 두 번째 쿼리의 첫 번째 컬럼도 숫자 타입이어야 합니다.

2. **성능 차이**:
    - **`UNION ALL`**은 중복을 제거하지 않으므로 **더 빠르게** 작동합니다.
    - **`UNION`**은 중복된 데이터를 제거하기 위해 **정렬 작업**이 필요하기 때문에 더 많은 리소스가 필요합니다. 데이터 양이 많을 때 성능에 영향을 줄 수 있습니다.

3. **중복 처리 여부**:
    - `UNION`은 중복된 데이터를 제거하여 반환하므로, 결과에서 중복을 원치 않을 때 유용합니다.
    - 반대로, 모든 데이터를 반환하고자 할 때는 `UNION ALL`을 사용하는 것이 적합합니다.

<br>

