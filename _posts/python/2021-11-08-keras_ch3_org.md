---
layout: single
title: "[케라스(keras) 이해] 3장. 신경망 시작하기"
excerpt: "케라스 창시자에게 배우는 딥러닝 요약"
categories: python
tag : [python, keras, DL]
toc: true
toc_sticky: true
author_profile: false

last_modified_at: 2021-11-08
---

## 3_1. 신경망의 구조

요소들

- 네트워크(또는 모델)를 구성하는 층
- 입력 데이터와 그에 상응하는 타깃
- 학습에 사용할 피드백 신호를 정의하는 손실 함수
- 학습 진행 방식을 결정하는 옵티마이저

## 3_1_1. 층: 딥러닝의 구성 단위

- **층** : 하나 이상의 텐서를 입력을 받아 하나 이상의 텐서를 출력하는 데이터 처리 모듈
  - 어떤 종류의 층은 상태가 없지만 대부분의 경우 **가중치**라는 층의 상태를 가진다.
- **가중치** : 확률적 경사 하강법에 의해 학습되는 하나 이상의 텐서이며, 여기에 네트워크가 학습한 지식이 담겨 있다. 

### 층이 2D텐서일때

- (samples, features) 크기의 2D텐서가 저장된 간단한 벡터 데이터는 완전 연결층(fully connected layer)이나 밀집 층(dense layer)이라고도 불리는 밀집 연결 층(densely connected layer)에 의해 처리되는 경우가 많다. (**Dense**)

### 층이 3D 텐서일때

- (samples, timesteps, features) 크기의 3D 텐서로 저장된 시퀀스 데이터는 보통 **LSTM** 같은 순환 층(recurrent layer)에 의해 처리된다.

### 층이 4D 텐서일때

- 4D 텐서로 저장되어 있는 이미지 데이터는 일반적으로 2D 합성곱 층(convolution layer)에 의해 처리된다. (**Conv2D**)

<br/>

- **층 호환성(layer compatibility)** : 각 층이 특정 크기의 입력텐서만 받고 특정 크기의 출력 텐서를 반환한다는 사실을 말한다.

![image](https://user-images.githubusercontent.com/78655692/140713986-67e25dcb-0742-4fc3-9da0-1f32a27f110a.png)

## 3_1_2. 모델: 층의 네트워크

- 네트워크 구조는 **가설 공간(hypothesis space)**을 정의한다.
  - 머신 러닝 : 가능성 있는 공간을 사전에 정의하고 피드백 신호의 도움을 받아 입력 데이터에 대한 유용한 변환을 찾는 것
- 네트워크 구조를 선택함으로써 가능성 있는 공간(가설 공간)을 입력 데이터에서 출력 데이터로 매핑하는 일련의 특정 텐서 연산으로 제한하게 된다.

## 3_1_3. 손실 함수와 옵티마이저 : 학습 과정을 조절하는 열쇠

- 네트워크 구조를 정의하고 나면 두 가지를 더 선택해야 한다.
- **손실 함수**(loss function) (= 목적함수(objective function)) : 훈련하는 동안 최소화될 값. 주어진 문제에 대한 성공 지표가 된다.
  - **binary crossentropy** : 2개의 클래스가 있는 분류 문제
  - **categorical crossentropy** : 여러 개의 클래스가 있는 분류 문제
  - **MSE(mean square error)** : 회귀 문제
  - **CTC(connection temporal classfication)** : 시퀀스 학습 문제


- **옵티마이저**(optimizer) : 손실 함수를 기반으로 네트워크가 어떻게 업데이트될지 결정한다.
  - 특정 종류의 확률적 경사 하강법(SGD)을 구현한다.

## 3_2_1. 케라스, 텐서플로, 씨아노, CNTK

- 케라스 : 딥러닝 모델을 만들기 위한 고수준의 구성 요소를 제공하는 모델 수준의 라이브러리
  - 텐서 조작이나 미분 같은 저수준의 연산을 다루지 않는다.
  - 그 대신 케라스의 백엔드 엔진에서 제공하는 최적화되고 특화된 텐서 라이브러리를 사용한다.

## 3_2_2. 케라스를 사용한 개발: 빠르게 둘러보기

- 전형적인 케라스 작업 흐름
    1. 입력 텐서와 타깃 텐서로 이루어진 훈련 데이터를 정의한다.
    2. 입력과 타깃을 매핑하는 층으로 이루어진 네트워크(또는 모델)를 정의한다.
    3. 손실 함수, 옵티마이저, 모니터링하기 위한 측정 지표를 선택하여 학습 과정을 설정한다.
    4. 훈련 데이터에 대해 모델의 fit() 메서드를 반복적으로 호출한다.

## 모델을 정의하는 방법

### 1. Sequential 클래스

- 가장 자주 사용하는 구조인 층을 순서대로 쌓아 올린 네트워크

![image](https://user-images.githubusercontent.com/78655692/140716645-573e8eff-7f41-43e6-863f-946deba8f23c.png)


### 2. 함수형 API

- 완전히 임의의 구조를 만들 수 있는 비순환 유향 그래프를 만든다.
- 함수형 API를 사용하면 모델이 처리할 데이터 텐서를 만들고 마치 함수처럼 이 텐서에 층을 적용한다.

![image](https://user-images.githubusercontent.com/78655692/140716898-5164ef30-b4c9-478a-99e8-ed41970ec0e5.png)


